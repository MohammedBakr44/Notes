
>1- Which networking libraries does the malware use, and what are their advantages? 

![](https://cdn.imgchest.com/files/7w6c2vgxxoy.png)

This malware uses `URLDownloadToCacheFileA`, which ensures the file is downloaded without blocking the user interface.

>This function always returns a file name, if the download operation succeeds. If the given URL is a "file:" URL, [**URLDownloadToCacheFile**](https://learn.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775122\(v=vs.85\)) directly returns the file name for the "file:" URL, instead of making a copy to the cache. If the given URL is an Internet URL, such as "http:" or "ftp:," **URLDownloadToCacheFile** downloads this file and returns the local file name of the cached copy. Use this function to ensure that a file name is returned without unnecessary copying of data.
- [source](https://learn.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775122(v=vs.85))

speculation: this function is used to blend in traffic as a normal cache validation process while downloading a payload.


